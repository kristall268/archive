## Проект: Управление проектом (CustomTkinter)

Приложение для управления задачами с зависимостями на базе Python, CustomTkinter и tkcalendar. Поддерживает добавление, редактирование, удаление задач, выбор зависимостей, автоматическое сохранение и экспорт в Excel.

### Требования
- Python 3.10+ (рекомендуется 3.10–3.12)
- Пакеты:
  - customtkinter
  - tkcalendar
  - openpyxl (для экспорта в Excel)

### Установка

**Linux/macOS:**
1. Установите Python 3.
2. (Опционально) создайте виртуальное окружение:
   ```bash
   python -m venv .venv
   source .venv/bin/activate
   ```
3. Установите зависимости:
   ```bash
   python -m pip install --upgrade pip
   python -m pip install customtkinter tkcalendar openpyxl
   ```

**Windows:**
1. Установите Python 3 с добавлением в PATH.
2. (Опционально) создайте виртуальное окружение:
   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   ```
3. Установите зависимости:
   ```bash
   python -m pip install --upgrade pip
   python -m pip install customtkinter tkcalendar openpyxl
   ```

### Запуск
- Запуск из консоли:
  ```bash
  python main.py
  ```
- Windows одним кликом: используйте файл `run_windows.bat` (установит зависимости при необходимости и запустит приложение).

### Структура проекта
- `main.py` — точка входа GUI
- `controller.py` — контроллеры (логика операций и валидации)
- `models.py` — модели данных и репозиторий задач
- `dialogs.py` — диалоговые окна (создание/редактирование/зависимости)
- `views.py` — таблица задач, заголовок, уведомления, меню
- `storage.py` — сохранение/загрузка данных и экспорт в Excel

### Функционал

#### Основные возможности
- ✅ Добавление, редактирование и удаление задач
- ✅ Управление зависимостями между задачами
- ✅ Автоматическое вычисление длительности задач
- ✅ Копирование и вставка задач (Ctrl+C, Ctrl+V)
- ✅ Контекстное меню (правая кнопка мыши)

#### Работа с данными
- **Автоматическое сохранение**: данные сохраняются каждые 30 секунд в файл `project_data.json`
- **Ручное сохранение**: меню "Файл" → "Сохранить"
- **Загрузка проекта**: меню "Файл" → "Открыть..." (выбор JSON файла)
- **Экспорт в Excel**: меню "Файл" → "Экспорт в Excel..." (создание .xlsx файла)
- **Автоматическая загрузка**: при запуске приложения автоматически загружаются данные из `project_data.json`

#### Формат файла данных
Данные сохраняются в формате JSON:
```json
{
  "version": "1.0",
  "saved_at": "11.11.2025 15:30:45",
  "tasks": [
    {
      "id": "WBS-01-13-001",
      "object": "Название объекта",
      "start_date": "01.11.2025",
      "end_date": "15.11.2025",
      "duration": 15,
      "dependencies": ["WBS-01-13-000 - Предыдущая задача"],
      "type": "FS - Finish-Start"
    }
  ]
}
```

#### Экспорт в Excel
Экспортированный Excel файл содержит:
- Все задачи проекта с форматированием
- Заголовки столбцов с цветовым оформлением
- Автоматическую ширину колонок
- Информацию о дате экспорта и количестве задач
- Форматированные зависимости (каждая с новой строки)

### Правила валидации (ключевые)
- Если у задачи есть зависимости, её дата начала не может совпадать с датой начала любой зависимости.
- Если это первая задача в списке:
  - зависимости очищаются (нет зависимостей),
  - тип зависимости устанавливается в `--`.

### Горячие клавиши
- `Delete` — удалить выбранную задачу
- `Ctrl+C` — копировать задачу в буфер обмена
- `Ctrl+V` — вставить задачу из буфера обмена
- `Double Click` — редактировать задачу (кроме колонки "Зависит от")
- `Single Click` (колонка "Зависит от") — выбор зависимостей

### Сборка .exe (опционально, Windows)
Вы можете собрать исполняемый файл с помощью PyInstaller:
```bash
python -m pip install pyinstaller
pyinstaller --noconfirm --onefile --windowed --name ProjectManager main.py
```
Готовый файл будет в `dist/ProjectManager.exe`.

### Примечания
- Tkinter входит в стандартную библиотеку Python, но на некоторых системах Linux может понадобиться пакет для Tk (например, `sudo apt install python3-tk`).
- Для корректного отображения шрифтов и стилей убедитесь, что система поддерживает рендеринг шрифтов Segoe UI или замените на доступные в вашей ОС.
- При закрытии приложения данные автоматически сохраняются.
- Файл `project_data.json` создается в той же директории, где находится `main.py`.

### Устранение неполадок

**Ошибка "openpyxl не установлен":**
```bash
pip install openpyxl
```

**Данные не сохраняются:**
- Проверьте права на запись в директорию приложения
- Убедитесь, что файл `project_data.json` не открыт в другой программе

**Проблемы с отображением шрифтов:**
- Установите шрифт Segoe UI или измените шрифты в коде на доступные в вашей системе